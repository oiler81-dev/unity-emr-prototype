<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UnityEMR Prototype</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="theme-light">
  <div id="app" class="app-shell" aria-live="polite">

    <!-- LEFT: Global Navigation -->
    <aside class="global-nav" aria-label="Global navigation">
      <div class="brand">
        <div class="brand-mark" id="brandMark" aria-label="UnityEMR logo">U</div>
        <div class="brand-text">
          <div class="brand-title">UnityEMR</div>
          <div class="brand-sub">Internal Prototype</div>
        </div>
      </div>

      <nav class="nav" role="navigation">
        <button class="nav-item is-active" data-route="schedule" id="navSchedule">
          <span class="nav-ico">üìÖ</span><span>Today</span>
        </button>
        <button class="nav-item" data-route="chart" id="navChart">
          <span class="nav-ico">üßë‚Äç‚öïÔ∏è</span><span>Chart</span>
        </button>
        <button class="nav-item" data-route="encounter" id="navEncounter">
          <span class="nav-ico">üìù</span><span>Encounter</span>
        </button>
        <button class="nav-item" data-route="admin" id="navAdmin">
          <span class="nav-ico">‚¨ÜÔ∏è</span><span>Imports</span>
          <span class="tag tag-muted" id="adminTag">Admin</span>
        </button>
      </nav>

      <div class="nav-footer">
        <div class="user-pill" id="userPill" role="button" tabindex="0" aria-label="User menu">
          <div class="avatar" id="userAvatar">NP</div>
          <div class="user-meta">
            <div class="user-name" id="userName">‚Äî</div>
            <div class="user-role" id="userRole">‚Äî</div>
          </div>
        </div>

        <div class="footer-actions">
          <button class="btn btn-ghost" id="themeToggle" title="Toggle theme (Alt+T)">Theme</button>
          <button class="btn btn-ghost" id="logoutBtn">Logout</button>
        </div>

        <div class="hint">
          <div><kbd>Ctrl</kbd>/<kbd>‚åò</kbd>+<kbd>K</kbd> Search</div>
          <div><kbd>G</kbd> then <kbd>T</kbd>/<kbd>P</kbd>/<kbd>E</kbd></div>
        </div>
      </div>
    </aside>

    <!-- MAIN COLUMN -->
    <main class="main" aria-label="Main workspace">
      <header class="topbar">
        <div class="topbar-left">
          <div class="context-title" id="contextTitle">Today</div>
          <div class="context-sub" id="contextSub">Schedule ‚Ä¢ Unity MSK</div>
        </div>

        <div class="topbar-right">
          <button class="btn btn-secondary" id="openSearchBtn" title="Patient search (Ctrl/‚åò+K)">
            Search Patients
          </button>
          <button class="btn btn-secondary" id="mockSyncBtn" title="Mock CSV sync">
            CSV Sync: <span class="sync-dot" id="syncDot"></span><span id="syncText">Idle</span>
          </button>
        </div>
      </header>

      <!-- CONTENT GRID: Secondary sidebar + Primary content -->
      <div class="content-grid">

        <!-- SECONDARY: Patient Chart Navigation (shows on chart/encounter) -->
        <aside class="chart-nav" id="chartNav" aria-label="Chart navigation">
          <div class="chart-nav-head">
            <div class="chart-nav-title">Chart</div>
            <div class="chart-nav-sub" id="chartNavSub">No patient selected</div>
          </div>

          <div class="chart-nav-section">
            <button class="subnav-item is-active" data-chart-section="summary">Summary</button>
            <button class="subnav-item" data-chart-section="problems">Problems + Note</button>
            <button class="subnav-item" data-chart-section="documents">Documents</button>
            <button class="subnav-item" data-chart-section="intake">Intake</button>
          </div>

          <div class="chart-nav-footer">
            <button class="btn btn-primary" id="startEncounterBtn">Start Encounter</button>
            <button class="btn btn-ghost" id="backToTodayBtn">Back to Today</button>
          </div>
        </aside>

        <!-- PRIMARY: Route Panels -->
        <section class="workspace" aria-label="Workspace">

          <!-- ROUTE: LOGIN (full overlay) -->
          <section class="route route-login" id="routeLogin" aria-label="Login">
            <div class="login-card">
              <div class="login-title">UnityEMR</div>
              <div class="login-sub">Mock SSO ‚Ä¢ Role-based prototype</div>

              <label class="field">
                <span>Sign in as</span>
                <select id="loginRole">
                  <option value="provider">Provider</option>
                  <option value="ma">Medical Assistant</option>
                  <option value="admin">Admin</option>
                </select>
              </label>

              <label class="field">
                <span>Display name</span>
                <input id="loginName" type="text" value="Nestor Perez" />
              </label>

              <button class="btn btn-primary btn-block" id="loginBtn">Continue</button>

              <div class="login-note">
                Prototype only ‚Ä¢ No PHI ‚Ä¢ Session simulated in-memory
              </div>
            </div>
          </section>

          <!-- ROUTE: TODAY / SCHEDULE -->
          <section class="route" id="routeSchedule" aria-label="Today schedule">
            <div class="panel schedule-panel">
              <div class="panel-head">
                <div class="panel-title">Today‚Äôs Schedule</div>
                <div class="panel-actions">
                  <button class="btn btn-ghost" id="densityToggle">Density: <span id="densityLabel">Comfort</span></button>
                </div>
              </div>

              <div class="schedule-toolbar">
                <div class="segmented" role="tablist" aria-label="Schedule view">
                  <button class="seg-item is-active" data-view="list">List</button>
                  <button class="seg-item" data-view="provider">By Provider</button>
                </div>

                <div class="filters">
                  <label class="field-inline">
                    <span>Status</span>
                    <select id="statusFilter">
                      <option value="all">All</option>
                      <option value="checkedin">Checked In</option>
                      <option value="arrived">Arrived</option>
                      <option value="roomed">Roomed</option>
                      <option value="complete">Complete</option>
                      <option value="noshow">No Show</option>
                    </select>
                  </label>

                  <label class="field-inline">
                    <span>Provider</span>
                    <select id="providerFilter">
                      <option value="all">All</option>
                    </select>
                  </label>
                </div>
              </div>

              <!-- fixed header + full-width list -->
              <div class="schedule-group-head">
                <div class="group-title" id="scheduleGroupTitle">All Providers</div>
                <div class="group-sub" id="scheduleGroupSub">‚Äî</div>
              </div>

              <div class="schedule-list" id="scheduleList"></div>
            </div>
          </section>

          <!-- ROUTE: CHART -->
          <section class="route" id="routeChart" aria-label="Patient chart">

            <div class="sticky-patient" id="patientHeader">
              <div class="patient-id">
                <div class="patient-photo" id="patientPhoto" aria-hidden="true"></div>
                <div class="patient-meta">
                  <div class="patient-name" id="patientName">No patient selected</div>
                  <div class="patient-demographics" id="patientDemo">‚Äî</div>
                </div>
              </div>

              <div class="patient-actions">
                <button class="btn btn-secondary" id="openEncounterBtn">Open Encounter</button>
                <button class="btn btn-ghost" id="mockExportBtn">Export to AdvancedMD</button>
              </div>
            </div>

            <div class="chart-content" id="chartContent"></div>
          </section>

          <!-- ROUTE: ENCOUNTER -->
          <section class="route" id="routeEncounter" aria-label="Encounter workspace">
            <div class="sticky-patient">
              <div class="patient-id">
                <div class="patient-photo" id="encPatientPhoto" aria-hidden="true"></div>
                <div class="patient-meta">
                  <div class="patient-name" id="encPatientName">No patient selected</div>
                  <div class="patient-demographics" id="encPatientDemo">‚Äî</div>
                </div>
              </div>

              <div class="enc-controls">
                <div class="pill" id="encStatusPill">Draft</div>
                <button class="btn btn-secondary" id="saveDraftBtn">Save Draft</button>
                <button class="btn btn-primary" id="signBtn">Sign</button>
                <button class="btn btn-ghost" id="newVersionBtn">New Version</button>
              </div>
            </div>

            <div class="note-shell">
              <div class="note-head">
                <div>
                  <div class="note-title" id="noteTitle">Orthopedic Note</div>
                  <div class="note-sub" id="noteSub">Template: Knee Pain Initial</div>
                </div>

                <div class="note-right">
                  <label class="field-inline">
                    <span>Template</span>
                    <select id="templateSelect">
                      <option value="knee_initial">Knee Pain Initial</option>
                      <option value="shoulder_initial">Shoulder Pain Initial</option>
                    </select>
                  </label>
                </div>
              </div>

              <div class="note-grid">
                <section class="note-pane">
                  <div class="pane-title">HPI</div>
                  <textarea id="hpiField" class="note-text" rows="6"></textarea>
                </section>

                <section class="note-pane">
                  <div class="pane-title">Exam</div>
                  <textarea id="examField" class="note-text" rows="6"></textarea>
                </section>

                <section class="note-pane">
                  <div class="pane-title">Assessment</div>
                  <textarea id="assessmentField" class="note-text" rows="5"></textarea>
                </section>

                <section class="note-pane">
                  <div class="pane-title">Plan</div>
                  <textarea id="planField" class="note-text" rows="5"></textarea>
                </section>

                <section class="note-pane">
                  <div class="pane-title">Dx</div>
                  <input id="dxField" class="note-input" type="text" placeholder="e.g., M17.11 Primary osteoarthritis of right knee" />
                  <div class="microcopy">Prototype: free-text ICD placeholder</div>
                </section>
              </div>
            </div>
          </section>

          <!-- ROUTE: ADMIN IMPORT -->
          <section class="route" id="routeAdmin" aria-label="Admin import">
            <div class="panel">
              <div class="panel-head">
                <div>
                  <div class="panel-title">Admin ‚Ä¢ CSV Import</div>
                  <div class="panel-sub">Mock Patients.csv + Visits.csv upload ‚Ä¢ Admin only</div>
                </div>
              </div>

              <div class="import-grid">
                <div class="import-box">
                  <div class="pane-title">Upload files</div>
                  <label class="field">
                    <span>Patients.csv</span>
                    <input type="file" id="patientsCsv" accept=".csv" />
                  </label>
                  <label class="field">
                    <span>Visits.csv</span>
                    <input type="file" id="visitsCsv" accept=".csv" />
                  </label>
                  <button class="btn btn-primary" id="runImportBtn">Run Import (Simulated)</button>
                  <div class="microcopy">No files are processed; results are mocked.</div>
                </div>

                <div class="import-box">
                  <div class="pane-title">Import results</div>
                  <pre class="pre" id="importResults">No import run yet.</pre>
                </div>
              </div>
            </div>
          </section>

        </section>
      </div>
    </main>
  </div>

  <!-- Patient Search Modal -->
  <div class="modal-backdrop" id="searchModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Patient search">
      <div class="modal-head">
        <div class="modal-title">Patient Search</div>
        <button class="btn btn-ghost" id="closeSearchBtn">Close</button>
      </div>

      <div class="modal-body">
        <label class="field">
          <span>Search</span>
          <input id="patientSearchInput" type="text" placeholder="Name, DOB, MRN (prototype)" autocomplete="off" />
        </label>

        <div class="results" id="patientSearchResults"></div>
      </div>

      <div class="modal-foot">
        <div class="microcopy">Tip: <kbd>‚Üë</kbd>/<kbd>‚Üì</kbd> to move, <kbd>Enter</kbd> to select</div>
      </div>
    </div>
  </div>

  <!-- Toasts -->
  <div class="toasts" id="toasts" aria-live="polite" aria-relevant="additions"></div>

  <script src="app.js"></script>
</body>
</html>
